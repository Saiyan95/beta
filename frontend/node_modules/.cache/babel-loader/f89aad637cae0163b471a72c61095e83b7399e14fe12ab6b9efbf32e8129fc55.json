{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sayda\\\\CascadeProjects\\\\beta-tech-support\\\\frontend\\\\src\\\\pages\\\\tickets\\\\TicketDetails.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { Container, Paper, Typography, Box, Grid, Chip, Divider, TextField, Button, CircularProgress, Card, CardContent, Avatar, IconButton, Menu, MenuItem, Dialog, DialogTitle, DialogContent, DialogActions, Alert, Badge } from '@mui/material';\nimport { Send as SendIcon, MoreVert as MoreVertIcon, AttachFile as AttachFileIcon, Check as CheckIcon } from '@mui/icons-material';\nimport axios from 'axios';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { getSocket, joinTicketRoom, onSocketEvent, offSocketEvent, sendTicketMessage, acceptTicket } from '../../services/socketService';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst getStatusColor = status => {\n  switch (status) {\n    case 'new':\n      return 'info';\n    case 'in_progress':\n      return 'warning';\n    case 'on_hold':\n      return 'error';\n    case 'resolved':\n      return 'success';\n    default:\n      return 'default';\n  }\n};\nconst getPriorityColor = priority => {\n  switch (priority) {\n    case 'urgent':\n      return 'error';\n    case 'high':\n      return 'warning';\n    case 'medium':\n      return 'info';\n    case 'low':\n      return 'success';\n    default:\n      return 'default';\n  }\n};\nconst TicketDetails = () => {\n  _s();\n  const {\n    id\n  } = useParams();\n  const {\n    user\n  } = useAuth();\n  const [ticket, setTicket] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [message, setMessage] = useState('');\n  const [messages, setMessages] = useState([]);\n  const [newMessageAlert, setNewMessageAlert] = useState(false);\n  const messagesEndRef = useRef(null);\n  const messagesContainerRef = useRef(null);\n  const [anchorEl, setAnchorEl] = useState(null);\n  const [statusDialog, setStatusDialog] = useState(false);\n  const [newStatus, setNewStatus] = useState('');\n  const [acceptingTicket, setAcceptingTicket] = useState(false);\n  useEffect(() => {\n    joinTicketRoom(id);\n    const handleMessageReceived = data => {\n      setMessages(prev => [...prev, data.message]);\n\n      // Check if the message is from someone else\n      if (data.message.sender._id !== user._id) {\n        setNewMessageAlert(true);\n      }\n\n      // If the user is at the bottom of the chat, scroll to the new message\n      const container = messagesContainerRef.current;\n      if (container && container.scrollHeight - container.scrollTop <= container.clientHeight + 100) {\n        scrollToBottom();\n      }\n    };\n    const handleTicketAccepted = data => {\n      if (data.ticketId === id) {\n        setTicket(prev => ({\n          ...prev,\n          assignedTo: {\n            _id: data.technicianId,\n            name: data.technicianName\n          },\n          status: 'in_progress'\n        }));\n      }\n    };\n    onSocketEvent('message_received', handleMessageReceived);\n    onSocketEvent('ticket_accepted', handleTicketAccepted);\n    fetchTicketDetails();\n    return () => {\n      offSocketEvent('message_received', handleMessageReceived);\n      offSocketEvent('ticket_accepted', handleTicketAccepted);\n    };\n  }, [id, user]);\n  const fetchTicketDetails = async () => {\n    try {\n      const [ticketRes, messagesRes] = await Promise.all([axios.get(`${process.env.REACT_APP_API_URL}/api/tickets/${id}`), axios.get(`${process.env.REACT_APP_API_URL}/api/tickets/${id}/messages`)]);\n      setTicket(ticketRes.data);\n      setMessages(messagesRes.data);\n      scrollToBottom();\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error('Error fetching ticket details:', err);\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Failed to load ticket details');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n    setNewMessageAlert(false);\n  };\n  const handleSendMessage = async () => {\n    if (!message.trim()) return;\n    try {\n      var _ticket$assignedTo;\n      const response = await axios.post(`${process.env.REACT_APP_API_URL}/api/tickets/${id}/messages`, {\n        content: message,\n        sender: user._id\n      });\n\n      // Determine the recipient (if client, send to assigned technician, if technician, send to client)\n      const recipientId = user.role === 'client' ? (_ticket$assignedTo = ticket.assignedTo) === null || _ticket$assignedTo === void 0 ? void 0 : _ticket$assignedTo._id : ticket.client._id;\n      sendTicketMessage({\n        ticketId: id,\n        message: response.data,\n        recipientId\n      });\n      setMessage('');\n      scrollToBottom();\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      console.error('Error sending message:', err);\n      setError(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || 'Failed to send message');\n    }\n  };\n  const handleStatusChange = async () => {\n    try {\n      await axios.patch(`${process.env.REACT_APP_API_URL}/api/tickets/${id}/status`, {\n        status: newStatus\n      });\n      setTicket(prev => ({\n        ...prev,\n        status: newStatus\n      }));\n      setStatusDialog(false);\n      setAnchorEl(null);\n    } catch (err) {\n      var _err$response3, _err$response3$data;\n      console.error('Error updating ticket status:', err);\n      setError(((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.message) || 'Failed to update ticket status');\n    }\n  };\n  const handleAcceptTicket = async () => {\n    if (!user || user.role !== 'technician') return;\n    setAcceptingTicket(true);\n    try {\n      // Update ticket in the database\n      const response = await axios.patch(`${process.env.REACT_APP_API_URL}/api/tickets/${id}/assign`, {\n        technicianId: user._id\n      });\n\n      // Update local state\n      setTicket(response.data);\n\n      // Notify the client and other technicians\n      acceptTicket({\n        ticketId: id,\n        clientId: ticket.client._id,\n        technicianId: user._id,\n        technicianName: user.name\n      });\n\n      // Add a system message about the acceptance\n      const systemMessage = {\n        content: `Ticket has been accepted by ${user.name}`,\n        sender: {\n          _id: 'system',\n          name: 'System'\n        },\n        timestamp: new Date().toISOString(),\n        isSystemMessage: true\n      };\n      setMessages(prev => [...prev, systemMessage]);\n    } catch (err) {\n      var _err$response4, _err$response4$data;\n      console.error('Error accepting ticket:', err);\n      setError(((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.message) || 'Failed to accept ticket');\n    } finally {\n      setAcceptingTicket(false);\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        height: '100vh'\n      },\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 7\n    }, this);\n  }\n  if (!ticket) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      children: /*#__PURE__*/_jsxDEV(Alert, {\n        severity: \"error\",\n        children: \"Ticket not found\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Container, {\n    maxWidth: \"lg\",\n    children: [/*#__PURE__*/_jsxDEV(Paper, {\n      sx: {\n        p: 3,\n        mb: 3\n      },\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          mb: 2\n        },\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h5\",\n          children: [\"Ticket #\", ticket.ticketNumber]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 11\n        }, this), (user.role === 'admin' || user.role === 'technician') && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(IconButton, {\n            onClick: e => setAnchorEl(e.currentTarget),\n            children: /*#__PURE__*/_jsxDEV(MoreVertIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Menu, {\n            anchorEl: anchorEl,\n            open: Boolean(anchorEl),\n            onClose: () => setAnchorEl(null),\n            children: /*#__PURE__*/_jsxDEV(MenuItem, {\n              onClick: () => {\n                setStatusDialog(true);\n                setAnchorEl(null);\n              },\n              children: \"Update Status\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 3,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          md: 6,\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"subtitle2\",\n            color: \"textSecondary\",\n            children: \"Status\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Chip, {\n            label: ticket.status.replace('_', ' '),\n            color: getStatusColor(ticket.status),\n            sx: {\n              mt: 1\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          md: 6,\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"subtitle2\",\n            color: \"textSecondary\",\n            children: \"Priority\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Chip, {\n            label: ticket.priority,\n            color: getPriorityColor(ticket.priority),\n            sx: {\n              mt: 1\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          md: 6,\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"subtitle2\",\n            color: \"textSecondary\",\n            children: \"Category\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"body1\",\n            children: ticket.category\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          md: 6,\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"subtitle2\",\n            color: \"textSecondary\",\n            children: \"Product\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"body1\",\n            children: ticket.product.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 11\n        }, this), ticket.product.serialNumber && /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          md: 6,\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"subtitle2\",\n            color: \"textSecondary\",\n            children: \"Serial Number\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"body1\",\n            children: ticket.product.serialNumber\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          md: 6,\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"subtitle2\",\n            color: \"textSecondary\",\n            children: \"Assigned To\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"body1\",\n            children: [ticket.assignedTo ? ticket.assignedTo.name : 'Not assigned', !ticket.assignedTo && user.role === 'technician' && /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"outlined\",\n              color: \"primary\",\n              size: \"small\",\n              startIcon: /*#__PURE__*/_jsxDEV(CheckIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 320,\n                columnNumber: 30\n              }, this),\n              onClick: handleAcceptTicket,\n              disabled: acceptingTicket,\n              sx: {\n                ml: 2\n              },\n              children: acceptingTicket ? 'Accepting...' : 'Accept Ticket'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"subtitle2\",\n            color: \"textSecondary\",\n            children: \"Description\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"body1\",\n            children: ticket.description\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Paper, {\n      sx: {\n        p: 3\n      },\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h6\",\n        gutterBottom: true,\n        children: \"Communication\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        ref: messagesContainerRef,\n        sx: {\n          height: '400px',\n          overflowY: 'auto',\n          mb: 2,\n          position: 'relative'\n        },\n        children: [messages.map((msg, index) => /*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            display: 'flex',\n            justifyContent: msg.sender._id === user._id ? 'flex-end' : 'flex-start',\n            mb: 2\n          },\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            sx: {\n              maxWidth: '70%',\n              bgcolor: msg.isSystemMessage ? 'grey.200' : msg.sender._id === user._id ? 'primary.light' : 'grey.100'\n            },\n            children: /*#__PURE__*/_jsxDEV(CardContent, {\n              sx: {\n                py: 1,\n                '&:last-child': {\n                  pb: 1\n                }\n              },\n              children: [/*#__PURE__*/_jsxDEV(Box, {\n                sx: {\n                  display: 'flex',\n                  alignItems: 'center',\n                  mb: 1\n                },\n                children: [/*#__PURE__*/_jsxDEV(Avatar, {\n                  sx: {\n                    width: 24,\n                    height: 24,\n                    mr: 1\n                  },\n                  children: msg.sender.name[0]\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 372,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"caption\",\n                  color: \"textSecondary\",\n                  children: [msg.sender.name, \" - \", new Date(msg.timestamp).toLocaleString()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 375,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 371,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"body2\",\n                children: msg.content\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 379,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 370,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 15\n          }, this)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 13\n        }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 11\n        }, this), newMessageAlert && /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          color: \"primary\",\n          size: \"small\",\n          onClick: scrollToBottom,\n          sx: {\n            position: 'absolute',\n            bottom: 10,\n            left: '50%',\n            transform: 'translateX(-50%)',\n            zIndex: 1\n          },\n          children: \"New messages \\u2193\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Divider, {\n        sx: {\n          mb: 2\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          display: 'flex',\n          gap: 1\n        },\n        children: [/*#__PURE__*/_jsxDEV(TextField, {\n          fullWidth: true,\n          placeholder: \"Type your message...\",\n          value: message,\n          onChange: e => setMessage(e.target.value),\n          onKeyPress: e => e.key === 'Enter' && handleSendMessage()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n          color: \"primary\",\n          children: /*#__PURE__*/_jsxDEV(AttachFileIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 416,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          endIcon: /*#__PURE__*/_jsxDEV(SendIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 22\n          }, this),\n          onClick: handleSendMessage,\n          children: \"Send\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 418,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: statusDialog,\n      onClose: () => setStatusDialog(false),\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        children: \"Update Ticket Status\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: /*#__PURE__*/_jsxDEV(TextField, {\n          select: true,\n          fullWidth: true,\n          value: newStatus,\n          onChange: e => setNewStatus(e.target.value),\n          sx: {\n            mt: 2\n          },\n          children: [/*#__PURE__*/_jsxDEV(MenuItem, {\n            value: \"new\",\n            children: \"New\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 439,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n            value: \"in_progress\",\n            children: \"In Progress\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 440,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n            value: \"on_hold\",\n            children: \"On Hold\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 441,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n            value: \"resolved\",\n            children: \"Resolved\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 432,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 431,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => setStatusDialog(false),\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleStatusChange,\n          variant: \"contained\",\n          children: \"Update\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 253,\n    columnNumber: 5\n  }, this);\n};\n_s(TicketDetails, \"bg5IikT+hgcF9sHCD02/sX7VAh0=\", false, function () {\n  return [useParams, useAuth];\n});\n_c = TicketDetails;\nexport default TicketDetails;\nvar _c;\n$RefreshReg$(_c, \"TicketDetails\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useParams","Container","Paper","Typography","Box","Grid","Chip","Divider","TextField","Button","CircularProgress","Card","CardContent","Avatar","IconButton","Menu","MenuItem","Dialog","DialogTitle","DialogContent","DialogActions","Alert","Badge","Send","SendIcon","MoreVert","MoreVertIcon","AttachFile","AttachFileIcon","Check","CheckIcon","axios","useAuth","getSocket","joinTicketRoom","onSocketEvent","offSocketEvent","sendTicketMessage","acceptTicket","jsxDEV","_jsxDEV","Fragment","_Fragment","getStatusColor","status","getPriorityColor","priority","TicketDetails","_s","id","user","ticket","setTicket","loading","setLoading","error","setError","message","setMessage","messages","setMessages","newMessageAlert","setNewMessageAlert","messagesEndRef","messagesContainerRef","anchorEl","setAnchorEl","statusDialog","setStatusDialog","newStatus","setNewStatus","acceptingTicket","setAcceptingTicket","handleMessageReceived","data","prev","sender","_id","container","current","scrollHeight","scrollTop","clientHeight","scrollToBottom","handleTicketAccepted","ticketId","assignedTo","technicianId","name","technicianName","fetchTicketDetails","ticketRes","messagesRes","Promise","all","get","process","env","REACT_APP_API_URL","err","_err$response","_err$response$data","console","response","_messagesEndRef$curre","scrollIntoView","behavior","handleSendMessage","trim","_ticket$assignedTo","post","content","recipientId","role","client","_err$response2","_err$response2$data","handleStatusChange","patch","_err$response3","_err$response3$data","handleAcceptTicket","clientId","systemMessage","timestamp","Date","toISOString","isSystemMessage","_err$response4","_err$response4$data","sx","display","justifyContent","alignItems","height","children","fileName","_jsxFileName","lineNumber","columnNumber","severity","maxWidth","p","mb","variant","ticketNumber","onClick","e","currentTarget","open","Boolean","onClose","spacing","item","xs","md","color","label","replace","mt","category","product","serialNumber","size","startIcon","disabled","ml","description","gutterBottom","ref","overflowY","position","map","msg","index","bgcolor","py","pb","width","mr","toLocaleString","bottom","left","transform","zIndex","gap","fullWidth","placeholder","value","onChange","target","onKeyPress","key","endIcon","select","_c","$RefreshReg$"],"sources":["C:/Users/sayda/CascadeProjects/beta-tech-support/frontend/src/pages/tickets/TicketDetails.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useParams } from 'react-router-dom';\nimport {\n  Container,\n  Paper,\n  Typography,\n  Box,\n  Grid,\n  Chip,\n  Divider,\n  TextField,\n  Button,\n  CircularProgress,\n  Card,\n  CardContent,\n  Avatar,\n  IconButton,\n  Menu,\n  MenuItem,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Alert,\n  Badge\n} from '@mui/material';\nimport {\n  Send as SendIcon,\n  MoreVert as MoreVertIcon,\n  AttachFile as AttachFileIcon,\n  Check as CheckIcon\n} from '@mui/icons-material';\nimport axios from 'axios';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { \n  getSocket, \n  joinTicketRoom, \n  onSocketEvent, \n  offSocketEvent, \n  sendTicketMessage,\n  acceptTicket \n} from '../../services/socketService';\n\nconst getStatusColor = (status) => {\n  switch (status) {\n    case 'new':\n      return 'info';\n    case 'in_progress':\n      return 'warning';\n    case 'on_hold':\n      return 'error';\n    case 'resolved':\n      return 'success';\n    default:\n      return 'default';\n  }\n};\n\nconst getPriorityColor = (priority) => {\n  switch (priority) {\n    case 'urgent':\n      return 'error';\n    case 'high':\n      return 'warning';\n    case 'medium':\n      return 'info';\n    case 'low':\n      return 'success';\n    default:\n      return 'default';\n  }\n};\n\nconst TicketDetails = () => {\n  const { id } = useParams();\n  const { user } = useAuth();\n  const [ticket, setTicket] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [message, setMessage] = useState('');\n  const [messages, setMessages] = useState([]);\n  const [newMessageAlert, setNewMessageAlert] = useState(false);\n  const messagesEndRef = useRef(null);\n  const messagesContainerRef = useRef(null);\n  const [anchorEl, setAnchorEl] = useState(null);\n  const [statusDialog, setStatusDialog] = useState(false);\n  const [newStatus, setNewStatus] = useState('');\n  const [acceptingTicket, setAcceptingTicket] = useState(false);\n\n  useEffect(() => {\n    joinTicketRoom(id);\n    \n    const handleMessageReceived = (data) => {\n      setMessages(prev => [...prev, data.message]);\n      \n      // Check if the message is from someone else\n      if (data.message.sender._id !== user._id) {\n        setNewMessageAlert(true);\n      }\n      \n      // If the user is at the bottom of the chat, scroll to the new message\n      const container = messagesContainerRef.current;\n      if (container && container.scrollHeight - container.scrollTop <= container.clientHeight + 100) {\n        scrollToBottom();\n      }\n    };\n    \n    const handleTicketAccepted = (data) => {\n      if (data.ticketId === id) {\n        setTicket(prev => ({\n          ...prev,\n          assignedTo: {\n            _id: data.technicianId,\n            name: data.technicianName\n          },\n          status: 'in_progress'\n        }));\n      }\n    };\n    \n    onSocketEvent('message_received', handleMessageReceived);\n    onSocketEvent('ticket_accepted', handleTicketAccepted);\n\n    fetchTicketDetails();\n\n    return () => {\n      offSocketEvent('message_received', handleMessageReceived);\n      offSocketEvent('ticket_accepted', handleTicketAccepted);\n    };\n  }, [id, user]);\n\n  const fetchTicketDetails = async () => {\n    try {\n      const [ticketRes, messagesRes] = await Promise.all([\n        axios.get(`${process.env.REACT_APP_API_URL}/api/tickets/${id}`),\n        axios.get(`${process.env.REACT_APP_API_URL}/api/tickets/${id}/messages`)\n      ]);\n      setTicket(ticketRes.data);\n      setMessages(messagesRes.data);\n      scrollToBottom();\n    } catch (err) {\n      console.error('Error fetching ticket details:', err);\n      setError(err.response?.data?.message || 'Failed to load ticket details');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n    setNewMessageAlert(false);\n  };\n\n  const handleSendMessage = async () => {\n    if (!message.trim()) return;\n\n    try {\n      const response = await axios.post(`${process.env.REACT_APP_API_URL}/api/tickets/${id}/messages`, {\n        content: message,\n        sender: user._id\n      });\n\n      // Determine the recipient (if client, send to assigned technician, if technician, send to client)\n      const recipientId = user.role === 'client' \n        ? ticket.assignedTo?._id \n        : ticket.client._id;\n\n      sendTicketMessage({\n        ticketId: id,\n        message: response.data,\n        recipientId\n      });\n\n      setMessage('');\n      scrollToBottom();\n    } catch (err) {\n      console.error('Error sending message:', err);\n      setError(err.response?.data?.message || 'Failed to send message');\n    }\n  };\n\n  const handleStatusChange = async () => {\n    try {\n      await axios.patch(`${process.env.REACT_APP_API_URL}/api/tickets/${id}/status`, {\n        status: newStatus\n      });\n      setTicket(prev => ({ ...prev, status: newStatus }));\n      setStatusDialog(false);\n      setAnchorEl(null);\n    } catch (err) {\n      console.error('Error updating ticket status:', err);\n      setError(err.response?.data?.message || 'Failed to update ticket status');\n    }\n  };\n\n  const handleAcceptTicket = async () => {\n    if (!user || user.role !== 'technician') return;\n    \n    setAcceptingTicket(true);\n    \n    try {\n      // Update ticket in the database\n      const response = await axios.patch(`${process.env.REACT_APP_API_URL}/api/tickets/${id}/assign`, {\n        technicianId: user._id\n      });\n      \n      // Update local state\n      setTicket(response.data);\n      \n      // Notify the client and other technicians\n      acceptTicket({\n        ticketId: id,\n        clientId: ticket.client._id,\n        technicianId: user._id,\n        technicianName: user.name\n      });\n      \n      // Add a system message about the acceptance\n      const systemMessage = {\n        content: `Ticket has been accepted by ${user.name}`,\n        sender: { _id: 'system', name: 'System' },\n        timestamp: new Date().toISOString(),\n        isSystemMessage: true\n      };\n      \n      setMessages(prev => [...prev, systemMessage]);\n      \n    } catch (err) {\n      console.error('Error accepting ticket:', err);\n      setError(err.response?.data?.message || 'Failed to accept ticket');\n    } finally {\n      setAcceptingTicket(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '100vh' }}>\n        <CircularProgress />\n      </Box>\n    );\n  }\n\n  if (!ticket) {\n    return (\n      <Container>\n        <Alert severity=\"error\">Ticket not found</Alert>\n      </Container>\n    );\n  }\n\n  return (\n    <Container maxWidth=\"lg\">\n      <Paper sx={{ p: 3, mb: 3 }}>\n        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n          <Typography variant=\"h5\">\n            Ticket #{ticket.ticketNumber}\n          </Typography>\n          {(user.role === 'admin' || user.role === 'technician') && (\n            <>\n              <IconButton onClick={(e) => setAnchorEl(e.currentTarget)}>\n                <MoreVertIcon />\n              </IconButton>\n              <Menu\n                anchorEl={anchorEl}\n                open={Boolean(anchorEl)}\n                onClose={() => setAnchorEl(null)}\n              >\n                <MenuItem onClick={() => {\n                  setStatusDialog(true);\n                  setAnchorEl(null);\n                }}>\n                  Update Status\n                </MenuItem>\n              </Menu>\n            </>\n          )}\n        </Box>\n\n        <Grid container spacing={3}>\n          <Grid item xs={12} md={6}>\n            <Typography variant=\"subtitle2\" color=\"textSecondary\">Status</Typography>\n            <Chip\n              label={ticket.status.replace('_', ' ')}\n              color={getStatusColor(ticket.status)}\n              sx={{ mt: 1 }}\n            />\n          </Grid>\n          <Grid item xs={12} md={6}>\n            <Typography variant=\"subtitle2\" color=\"textSecondary\">Priority</Typography>\n            <Chip\n              label={ticket.priority}\n              color={getPriorityColor(ticket.priority)}\n              sx={{ mt: 1 }}\n            />\n          </Grid>\n          <Grid item xs={12} md={6}>\n            <Typography variant=\"subtitle2\" color=\"textSecondary\">Category</Typography>\n            <Typography variant=\"body1\">{ticket.category}</Typography>\n          </Grid>\n          <Grid item xs={12} md={6}>\n            <Typography variant=\"subtitle2\" color=\"textSecondary\">Product</Typography>\n            <Typography variant=\"body1\">{ticket.product.name}</Typography>\n          </Grid>\n          {ticket.product.serialNumber && (\n            <Grid item xs={12} md={6}>\n              <Typography variant=\"subtitle2\" color=\"textSecondary\">Serial Number</Typography>\n              <Typography variant=\"body1\">{ticket.product.serialNumber}</Typography>\n            </Grid>\n          )}\n          <Grid item xs={12} md={6}>\n            <Typography variant=\"subtitle2\" color=\"textSecondary\">Assigned To</Typography>\n            <Typography variant=\"body1\">\n              {ticket.assignedTo ? ticket.assignedTo.name : 'Not assigned'}\n              {!ticket.assignedTo && user.role === 'technician' && (\n                <Button \n                  variant=\"outlined\" \n                  color=\"primary\" \n                  size=\"small\" \n                  startIcon={<CheckIcon />}\n                  onClick={handleAcceptTicket}\n                  disabled={acceptingTicket}\n                  sx={{ ml: 2 }}\n                >\n                  {acceptingTicket ? 'Accepting...' : 'Accept Ticket'}\n                </Button>\n              )}\n            </Typography>\n          </Grid>\n          <Grid item xs={12}>\n            <Typography variant=\"subtitle2\" color=\"textSecondary\">Description</Typography>\n            <Typography variant=\"body1\">{ticket.description}</Typography>\n          </Grid>\n        </Grid>\n      </Paper>\n\n      {/* Chat Section */}\n      <Paper sx={{ p: 3 }}>\n        <Typography variant=\"h6\" gutterBottom>\n          Communication\n        </Typography>\n        <Box \n          ref={messagesContainerRef}\n          sx={{ \n            height: '400px', \n            overflowY: 'auto', \n            mb: 2,\n            position: 'relative' \n          }}\n        >\n          {messages.map((msg, index) => (\n            <Box\n              key={index}\n              sx={{\n                display: 'flex',\n                justifyContent: msg.sender._id === user._id ? 'flex-end' : 'flex-start',\n                mb: 2\n              }}\n            >\n              <Card\n                sx={{\n                  maxWidth: '70%',\n                  bgcolor: msg.isSystemMessage \n                    ? 'grey.200'\n                    : msg.sender._id === user._id \n                      ? 'primary.light' \n                      : 'grey.100'\n                }}\n              >\n                <CardContent sx={{ py: 1, '&:last-child': { pb: 1 } }}>\n                  <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\n                    <Avatar sx={{ width: 24, height: 24, mr: 1 }}>\n                      {msg.sender.name[0]}\n                    </Avatar>\n                    <Typography variant=\"caption\" color=\"textSecondary\">\n                      {msg.sender.name} - {new Date(msg.timestamp).toLocaleString()}\n                    </Typography>\n                  </Box>\n                  <Typography variant=\"body2\">{msg.content}</Typography>\n                </CardContent>\n              </Card>\n            </Box>\n          ))}\n          <div ref={messagesEndRef} />\n          \n          {newMessageAlert && (\n            <Button \n              variant=\"contained\" \n              color=\"primary\"\n              size=\"small\"\n              onClick={scrollToBottom}\n              sx={{ \n                position: 'absolute', \n                bottom: 10, \n                left: '50%', \n                transform: 'translateX(-50%)',\n                zIndex: 1\n              }}\n            >\n              New messages â†“\n            </Button>\n          )}\n        </Box>\n\n        <Divider sx={{ mb: 2 }} />\n\n        <Box sx={{ display: 'flex', gap: 1 }}>\n          <TextField\n            fullWidth\n            placeholder=\"Type your message...\"\n            value={message}\n            onChange={(e) => setMessage(e.target.value)}\n            onKeyPress={(e) => e.key === 'Enter' && handleSendMessage()}\n          />\n          <IconButton color=\"primary\">\n            <AttachFileIcon />\n          </IconButton>\n          <Button\n            variant=\"contained\"\n            endIcon={<SendIcon />}\n            onClick={handleSendMessage}\n          >\n            Send\n          </Button>\n        </Box>\n      </Paper>\n\n      {/* Status Update Dialog */}\n      <Dialog open={statusDialog} onClose={() => setStatusDialog(false)}>\n        <DialogTitle>Update Ticket Status</DialogTitle>\n        <DialogContent>\n          <TextField\n            select\n            fullWidth\n            value={newStatus}\n            onChange={(e) => setNewStatus(e.target.value)}\n            sx={{ mt: 2 }}\n          >\n            <MenuItem value=\"new\">New</MenuItem>\n            <MenuItem value=\"in_progress\">In Progress</MenuItem>\n            <MenuItem value=\"on_hold\">On Hold</MenuItem>\n            <MenuItem value=\"resolved\">Resolved</MenuItem>\n          </TextField>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setStatusDialog(false)}>Cancel</Button>\n          <Button onClick={handleStatusChange} variant=\"contained\">\n            Update\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </Container>\n  );\n};\n\nexport default TicketDetails;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}